<script src="https://cdn.jsdelivr.net/gh/aframevr/aframe@1c2407b26c61958baa93967b5412487cd94b290b/dist/aframe-master.min.js"></script>
<script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>

<style>
  .arjs-loader {
    height: 100%;
    width: 100%;
    position: absolute;
    top: 0;
    left: 0;
    background-color: rgba(0, 0, 0, 0.8);
    z-index: 9999;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .arjs-loader div {
    text-align: center;
    font-size: 1.25em;
    color: white;
  }
</style>

<body style="margin:0; overflow:hidden;">
  <div class="arjs-loader">
    <div>Loading, please wait...</div>
  </div>

  <a-scene
    vr-mode-ui="enabled: false;"
    renderer="logarithmicDepthBuffer: true;"
    embedded
    arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false;"
  >

    <!-- 1 — COLOSSEUM (First) -->
    <a-nft
      id="colosseumMarker"
      type="nft"
      url="/textures/italy/marker"
      smooth="true"
      smoothCount="10"
      smoothTolerance=".01"
      smoothThreshold="5"
    >
      <a-entity
        id="colosseumModel"
        visible="false"
        position="0 -300 -100"
        scale="30 30 30"
        gltf-model="models/colosseum.glb"
        rotation="0 90 0"
      ></a-entity>
    </a-nft>

    <!-- 2 — TORII (Second) -->
    <a-nft
      id="toriiMarker"
      type="nft"
      url="/textures/japan/marker"
      smooth="true"
      smoothCount="10"
      smoothTolerance=".01"
      smoothThreshold="5"
    >

      <a-entity
        id="toriiModel"
        visible="false"
        position="20 -100 -50"
        scale="0.4 0.4 0.4"
        gltf-model="models/torii.glb"
        rotation="-90 0 0"
      ></a-entity>
    </a-nft>

    <!-- 3 — GEYSER (Third) -->
    <a-nft
      id="geyserMarker"
      type="nft"
      url="/textures/iceland/marker"
      smooth="true"
      smoothCount="10"
      smoothTolerance=".01"
      smoothThreshold="5"
    >
      <a-entity
        id="geyserModel"
        visible="false"
        position="75 0 0"
        scale="0.6 0.6 0.6"
        gltf-model="models/geyser.glb"
        rotation="-90 0 0"
      ></a-entity>
    </a-nft>

	    <!--  — Flower (Third) -->
	<a-nft
	id="flowersMarker"
	type="nft"
	url="/textures/flowers/marker"
	smooth="true"
	smoothCount="10"
	smoothTolerance=".01"
	smoothThreshold="5"
	>
	<a-entity
		id="flowersModel"
		visible="false"
		position="75 0 0"
		scale="0.6 0.6 0.6"
		gltf-model="models/geyser.glb"
		rotation="-90 0 0"
	></a-entity>
	</a-nft>
    <a-entity camera>
  <a-entity id="orderText"
            position="0 0.5 -1.5"
            text="value: FOLLOW THE path: Soil, Growing Flower,GROWN UP.; color: white; align: center; width: 0.7; baseline: center"
            visible="false">
  </a-entity>
  
    <a-entity id="soilFirst"
            position="0 0.5 -1.5"
            text="Scan the Soil First"
            visible="false">
  </a-entity>
  <a-entity id="soilScanned"
            position="0 0.5 -1.5"
            text="Soil Scanned. Scan the small plant"
            visible="false">
  </a-entity>
    <a-entity id="smallPlantScanned"
            position="0 0.5 -1.5"
            text="Small Plant Scanned. Scan the flower(s)"
            visible="false">
  </a-entity>
  <a-entity id="smallPlantFirst"
            position="0 0.5 -1.5"
            text="Scan the soil and the small plant first"
            visible="false">
  </a-entity>
  <a-entity id="end"
            position="0 0.5 -1.5"
            text="END"
            visible="false">
  </a-entity>
</a-entity>
  </a-scene>

  <script>
    let colosseumScanned = false;
    let toriiScanned = false;

  
  document.querySelector("a-scene").addEventListener("loaded", () => {
    const text = document.getElementById("orderText");

    // Show the text immediately
    text.setAttribute("visible", true);

    // Hide after 4 seconds
    setTimeout(() => {
      text.setAttribute("visible", false);
    }, 4000);
  });

    // 1 — Scan Colosseum
    document.querySelector("#colosseumMarker").addEventListener("markerFound", () => {
	
      colosseumScanned = true;
	  
      document.querySelector("#colosseumModel").setAttribute("visible", true);
      const colosseumScannedText = document.getElementById("soilScanned")
	  colosseumScannedText.setAttribute("visible", true);
	  // Hide after 4 seconds
	  setTimeout(() => {
      colosseumScannedText.setAttribute("visible", false);
    }, 5000);
    });

    // 2 — Scan Torii only if Colosseum scanned
    document.querySelector("#toriiMarker").addEventListener("markerFound", () => {
      if (colosseumScanned) {
		
        toriiScanned = true;
        document.querySelector("#toriiModel").setAttribute("visible", true);
		const smallPlantScannedText = document.getElementById("smallPlantScanned")
		smallPlantScannedText.setAttribute("visible", true);
	   setTimeout(() => {
      smallPlantScannedText.setAttribute("visible", false);
    }, 5000);
      } else {
        const soilFirstText = document.getElementById("soilFirst")
		soilFirstText.setAttribute("visible", true);
		setTimeout(() => {
      soilFirstText.setAttribute("visible", false);
    }, 5000);
      }
    });

    // 3 — Scan Geyser only if Torii scanned
    document.querySelector("#geyserMarker").addEventListener("markerFound", () => {
      if (colosseumScanned && toriiScanned) {
        document.querySelector("#geyserModel").setAttribute("visible", true);
        const end = document.getElementById("end")
		end.setAttribute("visible", true);
		setTimeout(() => {
      end.setAttribute("visible", false);
    }, 5000);
      } else {
		const smallPlantFirstText = document.getElementById("smallPlantFirst")
		smallPlantFirstText.setAttribute("visible", true);
		setTimeout(() => {
      smallPlantFirstText.setAttribute("visible", false);
    }, 5000);
      }
    });
	// 4 — Scan Flowers only if Torii scanned
	document.querySelector("#flowersMarker").addEventListener("markerFound", () => {
	if (colosseumScanned && toriiScanned) {
		document.querySelector("#flowersModel").setAttribute("visible", true);
		console.log("Flowers unlocked — sequence complete!");
		const end = document.getElementById("end")
		end.setAttribute("visible", true);
		setTimeout(() => {
      end.setAttribute("visible", false);
	  }, 5000);
	} else {
		const smallPlantFirstText = document.getElementById("smallPlantFirst")
		smallPlantFirstText.setAttribute("visible", true);
		setTimeout(() => {
      smallPlantFirstText.setAttribute("visible", false);
    }, 5000);
	}
	});
  </script>
</body>
